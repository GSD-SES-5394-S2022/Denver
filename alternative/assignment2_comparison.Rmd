---
title: "assignment2_comparison"
output: html_document
---
## Load Libraries
```{r}
library(ggplot2)
library(sf)
library(tidyverse)
library(tidycensus)
library(sp)
library(units)
library(here)
```

###Bring Combined Cities New Data csv in

```{r}
combinedtracts <- here("alternative",
                      "data",
                      "combined_cities",
                      "combined_tracts1.csv") %>%
  
  st_read() %>%
  mutate(new_basic = as.numeric(new_basic),
         new_retail = as.numeric(new_retail),
         new_service = as.numeric(new_service),
         new_oneperson_hh = as.numeric(new_oneperson_hh),
         new_twoperson_hh = as.numeric(new_twoperson_hh),
         new_total_tract_population = as.numeric(new_total_tract_population),
         new_total_housing_units = as.numeric(new_total_housing_units),
         new_hh_income_low = as.numeric(new_hh_income_low),
         new_hh_income_mid = as.numeric(new_hh_income_mid),
         new_hh_income_high = as.numeric(new_hh_income_high),
         new_nocar = as.numeric(new_nocar))
         
  
```
### Select relevant city data
```{r}
final_tracts_sel <- combinedtracts %>%
  select(GEOID, 
         new_oneperson_hh,
         new_twoperson_hh,
         new_total_tract_population,
         new_total_housing_units,
         new_hh_income_low,
         new_hh_income_mid,
         new_hh_income_high,
         new_nocar,
         new_basic,
         new_retail,
         new_service)
```

###Combining Original Tracts with New Tract Population/HHs
```{r}
final_tracts <- left_join(zones, final_tracts_sel)
```
##Visualizing Existing + Proposed Conditions
###Population
####Existing Population
```{r}
existing_pop_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = population),color=NA)

existing_pop_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Tract Population",
                       breaks = size_brks <- seq(0, 15000, by = 2500),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "People"))
```
####Proposed Population

```{r}
proposed_pop_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = new_total_tract_population),color=NA)

proposed_pop_map +
    scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Proposed Tract Population",
                       breaks = size_brks <- seq(0, 40000, by = 10000),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "People"))
```
###Existing Households
```{r}
existing_hh_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = housing_units),color=NA)

existing_hh_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Tract Housing Units",
                       breaks = size_brks <- seq(0, 7000, by = 1000),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Units"))
```
###Proposed Households
```{r}
proposed_hh_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = new_total_housing_units),color=NA)

proposed_hh_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Proposed Tract Housing Units",
                       breaks = size_brks <- seq(0, 15000, by = 2500),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Units"))
```
###Household Incomes
####Existing Low
```{r}
existing_lowincome_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = hh_income_low),color=NA)

existing_lowincome_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Low Income Households",
                       breaks = size_brks <- seq(0, 1200, by = 200),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```
####Proposed Low
```{r}
proposed_lowincome_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = new_hh_income_low),color=NA)

proposed_lowincome_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Proposed Low Income Households",
                       breaks = size_brks <- seq(0, 2500, by = 500),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```

####Existing Mid
```{r}
existing_midincome_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = hh_income_mid),color=NA)

existing_midincome_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Mid Income Households",
                       breaks = size_brks <- seq(0, 2000, by = 500),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```

####Proposed Mid
```{r}
proposed_midincome_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = new_hh_income_mid),color=NA)

proposed_midincome_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Proposed Mid Income Households",
                       breaks = size_brks <- seq(0, 6000, by = 1000),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```
####Existing High
```{r}
existing_highincome_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = hh_income_high),color=NA)

existing_highincome_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "High Income Households",
                       breaks = size_brks <- seq(0, 3500, by = 1000),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```
####Proposed High
```{r}
proposed_highincome_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = new_hh_income_high),color=NA)

proposed_highincome_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Proposed High Income Households",
                       breaks = size_brks <- seq(0, 12000, by = 2000),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```
###Zero Car
####Existing Zero Car Households
```{r}
existing_nocar_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = nocar),color=NA)

existing_nocar_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Zero Car Households",
                       breaks = size_brks <- seq(0, 1200, by = 200),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```
####Proposed Zero Car Households
```{r}
proposed_nocar_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = new_nocar),color=NA)

proposed_nocar_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Proposed Zero Car Households",
                       breaks = size_brks <- seq(0, 2000, by = 500),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```
###Existing One Person Households
```{r}
existing_oneperson_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = oneperson_hh),color=NA)

existing_oneperson_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "One-Person Households",
                       breaks = size_brks <- seq(0, 3000, by = 500),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```

###Proposed One Person Households
```{r}
proposed_oneperson_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = new_oneperson_hh),color=NA)

proposed_oneperson_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Proposed One-Person Households",
                       breaks = size_brks <- seq(0, 8000, by = 1200),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```
###Existing Two Person Households
```{r}
existing_twoperson_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = twoperson_hh),color=NA)

existing_twoperson_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Two-Person Households",
                       breaks = size_brks <- seq(0, 2500, by = 500),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```

###Proposed Two Person Households
```{r}
proposed_twoperson_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = new_twoperson_hh),color=NA)

proposed_twoperson_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Proposed Two-Person Households",
                       breaks = size_brks <- seq(0, 10000, by = 2000),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Households"))
```

###Existing Basic Employees
```{r}
existing_basic_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = basic_emp),color=NA)

existing_basic_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Basic Employees",
                       breaks = size_brks <- seq(0, 15000, by = 3000),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Employees"))
```

###Proposed Basic Employees
```{r}
proposed_basic_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = new_basic),color=NA)

proposed_basic_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Proposed Basic Employees",
                       breaks = size_brks <- seq(0, 30000, by = 5000),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Employees"))
```
###Existing Service Employees
```{r}
existing_service_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = service_emp),color=NA)

existing_service_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Service Employees",
                       breaks = size_brks <- seq(0, 60000, by = 10000),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Employees"))
```
###Proposed Service Employees
```{r}
proposed_service_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = new_service),color=NA)

proposed_service_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Proposed Service Employees",
                       breaks = size_brks <- seq(0, 90000, by = 15000),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Employees"))
```
###Existing Retail Employees
```{r}
existing_retail_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = retail_emp),color=NA)

existing_retail_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Retail Employees",
                       breaks = size_brks <- seq(0, 5000, by = 1000),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Employees"))
```

###Proposed Retail Employees
```{r}
proposed_retail_map <- ggplot(final_tracts)+
  geom_sf(aes(fill = new_retail),color=NA)

proposed_retail_map +
  scale_fill_viridis_c(option = "D",
                       begin = 1, end = 0,
                       name = "Proposed Retail Employees",
                       breaks = size_brks <- seq(0, 15000, by = 2500),
                       labels = paste(formatC(size_brks,
                                              format="f",
                                              digits=0),
                                      "Employees"))
```

###Summary Tables
####Existing
```{r}
final_tracts %>%
  pivot_longer(cols=c(nocar,
                      population,
                      housing_units,
                      hh_income_low,
                      hh_income_mid,
                      hh_income_high,
                      oneperson_hh,
                      twoperson_hh,
                      basic_emp, 
                      retail_emp, 
                      service_emp),
               names_to = "Variable",
               values_to = "value") %>%
  group_by(Variable) %>%
  summarize(Average = mean(value, na.rm=TRUE),
            `Standard deviation` = sd(value, na.rm=TRUE),
            Median = median(value, median(value, na.rm=TRUE)))
```
####Proposed
```{r}
final_tracts %>%
  pivot_longer(cols=c(new_nocar,
                      new_total_tract_population,
                      new_total_housing_units,
                      new_hh_income_low,
                      new_hh_income_mid,
                      new_hh_income_high,
                      new_oneperson_hh,
                      new_twoperson_hh,
                      new_basic, 
                      new_retail, 
                      new_service),
               names_to = "Variable",
               values_to = "value") %>%
  group_by(Variable) %>%
  summarize(Average = mean(value, na.rm=TRUE),
            `Standard deviation` = sd(value, na.rm=TRUE),
            Median = median(value, median(value, na.rm=TRUE)))
```